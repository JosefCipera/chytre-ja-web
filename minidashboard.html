<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Dashboard Demo</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f3f4f6;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        h1 {
            font-size: 1.875rem;
            font-weight: bold;
            color: #1f2937;
            text-align: center;
            margin-bottom: 2rem;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .card {
            background-color: #ffffff;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            cursor: pointer;
            transition: transform 0.15s ease-in-out;
        }

        .card:hover {
            transform: scale(1.05);
        }

        .card-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b7280;
        }

        .card-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1f2937;
            margin-top: 0.25rem;
        }

        .card-value.red {
            color: #ef4444;
        }

        .card-value.green {
            color: #10b981;
        }

        .card-value.purple {
            color: #8b5cf6;
        }

        .card-canvas {
            width: 100%;
            height: 6rem;
            margin-top: auto;
        }

        .card-canvas.gauge {
            height: 10rem;
        }

        .text-center {
            text-align: center;
        }
    </style>

    <!-- Načtení hlavičky a zápatí přes JavaScript -->
    <script>
        function loadHTML(url, elementId) {
            fetch(url)
                .then(response => response.text())
                .then(data => {
                    document.getElementById(elementId).innerHTML = data;
                })
                .catch(error => console.error('Chyba při načítání:', error));
        }
        window.onload = function () {
            loadHTML('header.html', 'header');
            loadHTML('footer.html', 'footer');
        };
    </script>
</head>

<body>
    <div id="header"></div> <!-- Hlavička se načte zde -->
    <div class="container">
        <h1>Aktuální firemní ukazatele</h1>
        <div class="grid">
            <!-- Card: Tržby -->
            <div class="card" onmouseenter="animateChart('salesCanvas')" onmouseleave="resetChart('salesCanvas')">
                <div>
                    <div class="card-title">Tržby</div>
                    <div class="card-value green">158,5 tis. Kč</div>
                </div>
                <canvas id="salesCanvas" class="card-canvas"></canvas>
            </div>
            <!-- Card: Cash Flow -->
            <div class="card" onmouseenter="animateChart('cashflowCanvas')" onmouseleave="resetChart('cashflowCanvas')">
                <div>
                    <div class="card-title">Cash Flow</div>
                    <div class="card-value red">-32 000 Kč</div>
                </div>
                <canvas id="cashflowCanvas" class="card-canvas"></canvas>
            </div>
            <!-- Card: Náklady -->
            <div class="card" onmouseenter="animateChart('expensesCanvas')" onmouseleave="resetChart('expensesCanvas')">
                <div>
                    <div class="card-title">Náklady</div>
                    <div class="card-value">85,2 tis. Kč</div>
                </div>
                <canvas id="expensesCanvas" class="card-canvas"></canvas>
            </div>
            <!-- Card: Ziskovost -->
            <div class="card" onmouseenter="animateChart('profitabilityCanvas')"
                onmouseleave="resetChart('profitabilityCanvas')">
                <div>
                    <div class="card-title text-center">Ziskovost</div>
                    <div class="card-value green text-center">45 %</div>
                </div>
                <canvas id="profitabilityCanvas" class="card-canvas gauge"></canvas>
            </div>
            <!-- Card: Počet klientů -->
            <div class="card" onmouseenter="animateChart('clientsCanvas')" onmouseleave="resetChart('clientsCanvas')">
                <div>
                    <div class="card-title">Počet klientů</div>
                    <div class="card-value">456</div>
                </div>
                <canvas id="clientsCanvas" class="card-canvas"></canvas>
            </div>
            <!-- Card: Skladové zásoby -->
            <div class="card" onmouseenter="animateChart('stockCanvas')" onmouseleave="resetChart('stockCanvas')">
                <div>
                    <div class="card-title">Skladové zásoby</div>
                    <div class="card-value">550 tis. Kč</div>
                </div>
                <canvas id="stockCanvas" class="card-canvas"></canvas>
            </div>
            <!-- Card: Průtok -->
            <div class="card" onmouseenter="animateChart('throughputCanvas')"
                onmouseleave="resetChart('throughputCanvas')">
                <div>
                    <div class="card-title">Průtok</div>
                    <div class="card-value">80 tis. Kč</div>
                </div>
                <canvas id="throughputCanvas" class="card-canvas"></canvas>
            </div>
            <!-- Card: Včasnost dodávek -->
            <div class="card" onmouseenter="animateChart('deliveryCanvas')" onmouseleave="resetChart('deliveryCanvas')">
                <div>
                    <div class="card-title text-center">Včasnost dodávek</div>
                    <div class="card-value purple text-center">98 %</div>
                </div>
                <canvas id="deliveryCanvas" class="card-canvas gauge"></canvas>
            </div>
            <!-- Card: Produktivita -->
            <div class="card" onmouseenter="animateChart('productivityCanvas')"
                onmouseleave="resetChart('productivityCanvas')">
                <div>
                    <div class="card-title">Produktivita</div>
                    <div class="card-value">1,2</div>
                </div>
                <canvas id="productivityCanvas" class="card-canvas"></canvas>
            </div>
            <!-- Card: Využití hrdla -->
            <div class="card" onmouseenter="animateChart('bottleneckCanvas')"
                onmouseleave="resetChart('bottleneckCanvas')">
                <div>
                    <div class="card-title text-center">Využití hrdla</div>
                    <div class="card-value text-center">85 %</div>
                </div>
                <canvas id="bottleneckCanvas" class="card-canvas gauge"></canvas>
            </div>
        </div>
    </div>

    <script>
        // Data pro grafy
        const salesData = [50, 60, 45, 70, 65, 80, 75];
        const cashflowData = [10, -5, -2, 8, -10, -15, -12];
        const expensesData = [25, 30, 28, 32, 35, 30, 31];
        const clientsData = [120, 130, 135, 140, 150, 145, 155];
        const stockData = [500, 520, 550, 480, 510, 530, 540];
        const throughputData = [75, 80, 78, 85, 90, 82, 88];
        const productivityData = [1.1, 1.2, 1.15, 1.25, 1.2, 1.3, 1.22];
        const profitabilityValue = 45;
        const deliveryValue = 98;
        const bottleneckValue = 85;

        // Funkce pro vykreslení čárového grafu s podporou animace
        function drawLineChart(canvas, data, color, pointIndex, isAnimating, animationValue) {
            if (!canvas || !canvas.getContext) return;
            const ctx = canvas.getContext('2d');
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.scale(dpr, dpr);

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const maxVal = Math.max(...data);
            const minVal = Math.min(...data);
            const range = maxVal - minVal || 1;

            ctx.beginPath();
            ctx.lineWidth = 4;
            ctx.strokeStyle = color;

            const animatedDataLength = isAnimating ? Math.floor(data.length * animationValue) : data.length;

            for (let i = 0; i < animatedDataLength; i++) {
                const value = data[i];
                const x = (i / (data.length - 1)) * rect.width;
                const y = range === 1 ? rect.height / 2 : (1 - ((value - minVal) / range)) * rect.height;

                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();

            if (animatedDataLength === data.length) {
                const value = data[pointIndex];
                const pointX = (pointIndex / (data.length - 1)) * rect.width;
                const pointY = range === 1 ? rect.height / 2 : (1 - ((value - minVal) / range)) * rect.height;

                ctx.beginPath();
                ctx.arc(pointX, pointY, 6, 0, 2 * Math.PI);
                ctx.fillStyle = '#ffffff';
                ctx.fill();
                ctx.lineWidth = 2;
                ctx.strokeStyle = color;
                ctx.stroke();
            }
        }

        // Funkce pro vykreslení sloupcového grafu s animací a zdůrazněním
        function drawBarChart(canvas, data, color, highlightIndex, isAnimating, animationValue) {
            if (!canvas || !canvas.getContext) return;
            const ctx = canvas.getContext('2d');
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.scale(dpr, dpr);
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const maxVal = Math.max(...data);
            const minVal = Math.min(0, ...data);
            const range = maxVal - minVal || 1;

            const barWidth = (rect.width / data.length) * 0.7;
            const gap = (rect.width / data.length) * 0.3;
            const zeroLineY = range === 1 ? rect.height / 2 : (1 - (0 - minVal) / range) * rect.height;
            const radius = 5;

            data.forEach((value, index) => {
                const x = index * (barWidth + gap) + gap / 2;
                let barHeight = range === 1 ? 0 : Math.abs(value / range) * rect.height;
                if (isAnimating) {
                    barHeight *= animationValue;
                }
                const y = value >= 0 ? zeroLineY - barHeight : zeroLineY;

                ctx.beginPath();
                ctx.moveTo(x + radius, y);
                ctx.lineTo(x + barWidth - radius, y);
                ctx.arcTo(x + barWidth, y, x + barWidth, y + radius, radius);
                ctx.lineTo(x + barWidth, y + barHeight - radius);
                ctx.arcTo(x + barWidth, y + barHeight, x + barWidth - radius, y + barHeight, radius);
                ctx.lineTo(x + radius, y + barHeight);
                ctx.arcTo(x, y + barHeight, x, y + barHeight - radius, radius);
                ctx.lineTo(x, y + radius);
                ctx.arcTo(x, y, x + radius, y, radius);
                ctx.closePath();

                if (index === highlightIndex) {
                    ctx.strokeStyle = '#60a5fa'; // Stejná barva jako výplň sousedních sloupců
                    ctx.lineWidth = 1; // Slabší obrys
                    ctx.stroke();
                } else {
                    ctx.fillStyle = color;
                    ctx.fill();
                }
            });
        }

        // Funkce pro vykreslení donut grafu s animací
        function drawGaugeChart(canvas, value, maxValue, color, isAnimating, animationValue) {
            if (!canvas || !canvas.getContext) return;
            const ctx = canvas.getContext('2d');
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.scale(dpr, dpr);
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const centerX = rect.width / 2;
            const centerY = rect.height / 2;
            const outerRadius = Math.min(centerX, centerY) * 0.8;
            const innerRadius = outerRadius * 0.7;
            const startAngle = -Math.PI / 2;

            ctx.beginPath();
            ctx.arc(centerX, centerY, outerRadius, 0, 2 * Math.PI);
            ctx.arc(centerX, centerY, innerRadius, 2 * Math.PI, 0, true);
            ctx.fillStyle = '#e5e7eb';
            ctx.fill();

            const normalizedValue = Math.min(Math.max(value, 0), maxValue);
            let endAngle = startAngle + (normalizedValue / maxValue) * 2 * Math.PI;
            if (isAnimating) {
                endAngle = startAngle + (normalizedValue / maxValue) * 2 * Math.PI * animationValue;
            }
            ctx.beginPath();
            ctx.arc(centerX, centerY, outerRadius, startAngle, endAngle);
            ctx.arc(centerX, centerY, innerRadius, endAngle, startAngle, true);
            ctx.fillStyle = color;
            ctx.fill();
        }

        // Globální animace
        let animationFrameId = null;
        let animationStartTime = null;
        let animationValue = 1;
        let currentCanvasId = null;

        function animateChart(canvasId) {
            if (animationFrameId) cancelAnimationFrame(animationFrameId);
            animationValue = 0;
            animationStartTime = performance.now();
            currentCanvasId = canvasId;

            function animate(timestamp) {
                const duration = 1000;
                animationValue = Math.min(1, (timestamp - animationStartTime) / duration);
                renderSingleChart(currentCanvasId, true, animationValue);
                if (animationValue < 1) {
                    animationFrameId = requestAnimationFrame(animate);
                }
            }
            animationFrameId = requestAnimationFrame(animate);
        }

        function resetChart(canvasId) {
            if (animationFrameId) cancelAnimationFrame(animationFrameId);
            animationValue = 1;
            renderSingleChart(canvasId, false, 1);
        }

        // Funkce pro vykreslení jednoho grafu
        function renderSingleChart(id, isAnimating, animationValue) {
            const canvas = document.getElementById(id);
            if (!canvas) return;

            const charts = {
                'salesCanvas': () => drawLineChart(canvas, salesData, '#10b981', 1, isAnimating, animationValue),
                'cashflowCanvas': () => drawLineChart(canvas, cashflowData, '#ef4444', 3, isAnimating, animationValue),
                'expensesCanvas': () => drawLineChart(canvas, expensesData, '#3b82f6', expensesData.length - 2, isAnimating, animationValue),
                'clientsCanvas': () => drawLineChart(canvas, clientsData, '#f59e0b', Math.floor(clientsData.length / 3) + 1, isAnimating, animationValue),
                'throughputCanvas': () => drawLineChart(canvas, throughputData, '#8b5cf6', throughputData.length - 3, isAnimating, animationValue),
                'productivityCanvas': () => drawLineChart(canvas, productivityData, '#f97316', 1, isAnimating, animationValue),
                'stockCanvas': () => drawBarChart(canvas, stockData, '#60a5fa', stockData.length - 3, isAnimating, animationValue),
                'profitabilityCanvas': () => drawGaugeChart(canvas, profitabilityValue, 100, '#10b981', isAnimating, animationValue),
                'deliveryCanvas': () => drawGaugeChart(canvas, deliveryValue, 100, '#8b5cf6', isAnimating, animationValue),
                'bottleneckCanvas': () => drawGaugeChart(canvas, bottleneckValue, 100, '#14b8a6', isAnimating, animationValue)
            };

            if (charts[id]) charts[id]();
        }

        // Počáteční vykreslení všech grafů
        function renderCharts() {
            const canvasIds = [
                'salesCanvas', 'cashflowCanvas', 'expensesCanvas', 'profitabilityCanvas',
                'clientsCanvas', 'stockCanvas', 'throughputCanvas', 'deliveryCanvas',
                'productivityCanvas', 'bottleneckCanvas'
            ];
            canvasIds.forEach(id => renderSingleChart(id, false, 1));
        }

        // Spuštění při načtení a při změně velikosti okna
        window.addEventListener('load', () => {
            setTimeout(renderCharts, 0);
        });
        window.addEventListener('resize', renderCharts);
    </script>
</body>
<div id="footer"></div>

</html>